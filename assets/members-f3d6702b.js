import{d as Y,r as p,b as I,v as Z,G as ee,c as s,H as le,o as V,e as N,g as e,w as o,i as _,I as oe,j as S,h as n,f as i,F as ae,l as te,t as se,J as ne,K as re,L as b,M as de,N as ue,O as pe,p as ie,k as ce,_ as me}from"./index-4a914cf9.js";const x=w=>(ie("data-v-9746677c"),w=w(),ce(),w),_e=x(()=>i("h4",null,"分配用户角色",-1)),fe=x(()=>i("p",{style:{"line-height":"32px"},class:""},"用户名",-1)),ge=x(()=>i("p",{style:{"line-height":"32px"},class:""},"持有者",-1)),ye={style:{display:"flex"}},ve=x(()=>i("p",null,"职位列表",-1)),be={style:{flex:"auto"}},we={class:"dialog-footer"},$=12,Ve=Y({__name:"members",setup(w){let f=p(1),R=p(0),D=p([]),A=p(0),c=p(!1),h=p(!1);const g=p(!1);let F=I([]),r=I({_id:"",username:"",possessor:"",roleId:""});const d=I({username:"",password:"",possessor:""}),z=async()=>{(await re(d.username,d.password,d.possessor)).code==200?(b({type:"success",message:"添加成功"}),y(1),g.value=!1):b({type:"error",message:"添加失败，请稍后重试"})},B=async()=>{const t=await de(r);c.value=!1,t.code==200&&(b({type:"success",message:"修改成功"}),y(f.value))},P=async t=>{r._id=t._id,r.username=t.username,r.possessor=t.possessor,r.roleId=t.roleId,console.log(t),c.value=!0},y=async t=>{h.value=!0;let a=await ue(t,$);R.value=a.totalCount,D.value=a.data,A.value=a.totalPage,h.value=!1},E=t=>{f.value=t,y(f.value)},L=async t=>{(await pe(t)).code==200?(b({type:"success",message:"删除成功"}),y(f.value)):b({type:"error",message:"服务器异常，请稍后重试"})},M=async()=>{g.value=!0};return Z(async()=>{(await ee()).data.forEach(a=>{F.push(a)}),y(1)}),(t,a)=>{const m=s("el-button"),u=s("el-table-column"),j=s("el-popconfirm"),T=s("el-table"),G=s("el-pagination"),H=s("el-card"),v=s("el-input"),U=s("el-row"),J=s("el-radio"),K=s("el-radio-group"),O=s("el-drawer"),C=s("el-form-item"),q=s("el-form"),Q=s("el-dialog"),W=le("loading");return V(),N("div",null,[e(H,{class:"box-card",shadow:"always"},{header:o(()=>[e(m,{type:"primary",icon:"Plus",onClick:M},{default:o(()=>[_(" 添加用户 ")]),_:1})]),default:o(()=>[oe((V(),S(T,{border:"",data:n(D),"element-loading-text":"加载中..."},{default:o(()=>[e(u,{label:"序号",type:"index",align:"center"}),e(u,{prop:"username",label:"用户名",align:"center"}),e(u,{prop:"possessor",label:"持有者",align:"center"},{default:o(({row:l,$index:k})=>[]),_:1}),e(u,{prop:"roleName",label:"用户角色",align:"center"},{default:o(({row:l,$index:k})=>[]),_:1}),e(u,{prop:"registrationDate",label:"创建时间",align:"center"},{default:o(({row:l,$index:k})=>[]),_:1}),e(u,{prop:"lastUpdateTime",label:"修改时间",align:"center"}),e(u,{prop:"eee",label:"操作",align:"center"},{default:o(({row:l,$index:k})=>[e(m,{type:"primary",size:"small",icon:"User",onClick:X=>P(l)},{default:o(()=>[_("分配角色")]),_:2},1032,["onClick"]),e(j,{title:"6",onConfirm:X=>L(l._id)},{reference:o(()=>[e(m,{type:"danger",size:"small",icon:"Delete"})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[W,n(h)]]),e(G,{"current-page":n(f),"page-size":$,layout:"prev, pager, next, jumper, total","hide-on-single-page":"",total:n(R),onCurrentChange:E},null,8,["current-page","total"])]),_:1}),e(O,{modelValue:n(c),"onUpdate:modelValue":a[3]||(a[3]=l=>ne(c)?c.value=l:c=l)},{header:o(()=>[_e]),default:o(()=>[e(U,{class:"drawerRow"},{default:o(()=>[fe,e(v,{modelValue:n(r).username,"onUpdate:modelValue":a[0]||(a[0]=l=>n(r).username=l),placeholder:n(r).username,style:{width:"250px"},clearable:""},null,8,["modelValue","placeholder"])]),_:1}),e(U,{class:"drawerRow"},{default:o(()=>[ge,e(v,{modelValue:n(r).possessor,"onUpdate:modelValue":a[1]||(a[1]=l=>n(r).possessor=l),placeholder:n(r).possessor,style:{width:"250px"},clearable:""},null,8,["modelValue","placeholder"])]),_:1}),e(U,{class:"drawerRow"},{default:o(()=>[i("div",ye,[ve,e(K,{modelValue:n(r).roleId,"onUpdate:modelValue":a[2]||(a[2]=l=>n(r).roleId=l),style:{"margin-top":"30px"}},{default:o(()=>[(V(!0),N(ae,null,te(n(F),l=>(V(),S(J,{label:l._id,border:"",key:l._id},{default:o(()=>[_(se(l.roleName),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),footer:o(()=>[i("div",be,[e(m,{type:"primary",onClick:B},{default:o(()=>[_("确认")]),_:1})])]),_:1},8,["modelValue"]),e(Q,{modelValue:g.value,"onUpdate:modelValue":a[8]||(a[8]=l=>g.value=l),title:"Shipping address"},{footer:o(()=>[i("span",we,[e(m,{onClick:a[7]||(a[7]=l=>g.value=!1)},{default:o(()=>[_("取消")]),_:1}),e(m,{type:"primary",onClick:z},{default:o(()=>[_(" 提交 ")]),_:1})])]),default:o(()=>[e(q,{model:d},{default:o(()=>[e(C,{label:"用户名"},{default:o(()=>[e(v,{modelValue:d.username,"onUpdate:modelValue":a[4]||(a[4]=l=>d.username=l),autocomplete:"off",style:{width:"330px"}},null,8,["modelValue"])]),_:1}),e(C,{label:"密码"},{default:o(()=>[e(v,{type:"password",modelValue:d.password,"onUpdate:modelValue":a[5]||(a[5]=l=>d.password=l),autocomplete:"off",style:{width:"330px"}},null,8,["modelValue"])]),_:1}),e(C,{label:"持有人"},{default:o(()=>[e(v,{modelValue:d.possessor,"onUpdate:modelValue":a[6]||(a[6]=l=>d.possessor=l),autocomplete:"off",style:{width:"330px"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});const he=me(Ve,[["__scopeId","data-v-9746677c"]]);export{he as default};
