import{d as Xe,r as p,b as H,u as Ye,s as Ze,c as r,G as el,o as m,e as T,g as e,H as ll,h as s,w as l,i as _,I as j,j as x,f as y,n as R,J as U,F as fe,l as ve,t as J,y as ge,W as be,R as tl,L as h,p as al,k as ol,z as sl,_ as nl}from"./index-0d643a49.js";import{b as rl,c as il,d as he,e as dl}from"./index-e42c6dea.js";import{c as ul}from"./index-b80b8b8d.js";const pl=z=>(al("data-v-ee5666eb"),z=z(),ol(),z),cl={id:"container"},ml={class:"demo-image__preview"},_l=["src"],fl={class:"slider-demo-block",style:{width:"50%"}},vl=["src"],gl={key:0,"element-loading-text":"加载中..."},bl={style:{display:"inline-flex","align-items":"center"}},hl=pl(()=>y("span",null,"产品图片",-1)),yl=["src"],wl={id:"showBigProductImg"},Vl=["src"],xl={key:1},ye=3,kl=Xe({__name:"sku",setup(z){let B=p(1),we=p(8),X=p([]),Ve=p(3),Q=p(""),g=p(!1),Y=p([]),k=p(),n=H({_id:0,brandName:"",productName:"",description:"",services:{hasSevenDaysReturn:!1,hasAfterSalesWarranty:!1,hasThreeForOneGuarantee:!1},movementType:"",photo:""}),M=p(),$=p(!1),Z=p(1);const d=H({_id:"",color:"",productName:"",purchasingPrice:0,current_selling_price:0,isSale:"",productPhoto:"",sales:0,stock:0,allColor:[]});let ee=p(),N=p(),P=p(""),S=p(""),le=p(""),te=p(""),w=p(!1),L=p(0);const F=Ye();let b=p(!1);const i=H({productName:"",color:"",purchasingPrice:"",current_selling_price:"",stock:"",sales:"",isSale:"",productPhoto:""}),xe=()=>{tl.alert(`是否将商品${d.isSale?"下架":"上架"}`,`${d.isSale?"下架":"上架"}`,{confirmButtonText:"OK",callback:o=>{o=="confirm"?console.log(o):h({type:"info",message:"已取消操作"})}})},V=H({drawerLoading:!1,tableLoading:!1}),ae=async o=>{V.tableLoading=!0;let t=await rl(o,ye);X.value=t.data,V.tableLoading=!1},G=o=>{B.value=o,ae(o)},oe=o=>{o?(n._id=o._id,n.brandName=o.brandName,n.productName=o.productName,n.description=o.description,n.services=o.services,n.movementType=o.movementType,n.photo=o.photo,Q.value="修改商品信息",M.value=!0):(n._id=0,n.brandName="",n.productName="",n.description="",n.services={hasSevenDaysReturn:!1,hasAfterSalesWarranty:!1,hasThreeForOneGuarantee:!1},n.movementType="",n.photo="",Q.value="添加商品",M.value=!1),sl(()=>{var t,u,f,I;(t=k.value)==null||t.clearValidate("brandName"),(u=k.value)==null||u.clearValidate("movementType"),(f=k.value)==null||f.clearValidate("productName"),(I=k.value)==null||I.clearValidate("photo")}),g.value=!0},ke=()=>{oe()},Ne=o=>{oe(o)},Pe=(o,t,u)=>{t.trim().length>=1?u():(h({type:"error",message:"必须选择属于哪一个品牌"}),u(new Error("必须选择属于哪一个品牌")))},se=(o,t,u)=>{t.trim().length>=1?u():u(new Error("必须填写"))},ne={brandName:[{required:!0,trigger:"blur",validator:Pe}],movementType:[{required:!0,trigger:"blur",validator:se}],productName:[{required:!0,trigger:"blur",validator:se}],photo:[{required:!0,validator:(o,t,u)=>{t?u():(h({type:"error",message:"商品图片必须上传"}),u(new Error("商品图片必须上传")))}}]},re=o=>o.size/1024/1024<4?o.type=="image/jpeg"||o.type=="image/png"||o.type=="image/gif"||o.type=="image/webp"?!0:(h({type:"error",message:"上传文件格式必须为JPG、PNG、GIT、WEBP"}),!1):(h({type:"error",message:"上传文件大小必须小于4M"}),!1),Se=o=>{console.log(o.imageUrl),n.photo=o.imageUrl+"?imageMogr2/format/webp/blur/1x0/quality/66"},Ce=o=>{console.log(o.imageUrl),i.productPhoto=o.imageUrl+"?imageMogr2/format/webp/blur/1x0/quality/66"},Te=async()=>{await k.value.validate(),g.value=!1,(await il(n)).code==200?h({type:"success",message:"提交成功！"}):h({type:"error",message:"服务器异常，请稍后重试"}),n._id&&n._id!==0?G(B.value):G(Ve.value)},ie=o=>{o.data?(d._id=o.data._id,d.color=o.data.color,d.allColor=o.data.allColor,d.productName=o.data.productName,d.purchasingPrice=o.data.purchasingPrice,d.current_selling_price=o.data.current_selling_price,d.isSale=o.data.isSale,d.sales=o.data.sales,d.stock=o.data.stock,d.productPhoto=o.data.productPhoto):d._id=""},Ue=async o=>{Z.value=1,$.value=!0,V.drawerLoading=!0;const t=await he({productName:o.productName,pageNumber:Z.value});ie(t),V.drawerLoading=!1},Ie=async(o,t)=>{V.drawerLoading=!0,L.value=t-1;const u=await he({productName:o,pageNumber:t});ie(u),V.drawerLoading=!1},De=o=>{const t=ee.value.getBoundingClientRect();P.value=o.clientY-t.top-N.value.offsetHeight/2,S.value=o.clientX-t.left-N.value.offsetWidth/2,P.value=P.value<0?0:P.value>300-N.value.offsetHeight?300-N.value.offsetHeight:P.value,S.value=S.value<0?0:S.value>300-N.value.offsetHeight?300-N.value.offsetHeight:S.value,le.value=-P.value*3,te.value=-S.value*3},$e=o=>{b.value=!0,i.brandName=o.brandName,i.productName=o.productName},Le=()=>{i.productName="",i.color="",i.purchasingPrice="",i.current_selling_price="",i.stock="",i.sales="",i.isSale="",i.productPhoto=""},ze=async()=>{(await dl(i)).code==200?(b.value=!1,Le(),G(B.value),h({type:"success",message:"提交成功！"})):h({type:"error",message:"服务器异常，请稍后重试"})};return Ze(async()=>{ae(1),Y.value=(await ul()).data}),(o,t)=>{const u=r("el-button"),f=r("el-table-column"),I=r("el-tag"),Be=r("el-image"),Me=r("el-popconfirm"),Fe=r("el-table"),Ge=r("el-pagination"),Ae=r("el-card"),Ee=r("el-option"),Oe=r("el-select"),c=r("el-form-item"),D=r("el-input"),q=r("el-checkbox"),de=r("Plus"),A=r("el-icon"),ue=r("el-upload"),pe=r("el-form"),ce=r("el-dialog"),K=r("el-input-number"),We=r("el-slider"),He=r("el-switch"),me=r("el-tooltip"),C=r("el-statistic"),v=r("el-col"),E=r("el-row"),je=r("QuestionFilled"),Je=r("el-step"),Qe=r("el-steps"),qe=r("Bell"),Ke=r("el-text"),Re=r("el-drawer"),_e=el("loading");return m(),T("div",cl,[e(Ae,{class:"box-card",shadow:"always"},ll({default:l(()=>[j((m(),x(Fe,{border:"",data:s(X),"element-loading-text":"加载中..."},{default:l(()=>[e(f,{label:"序号",type:"index",align:"center",width:"60"}),e(f,{prop:"brandName",label:"品牌名称",align:"center",width:"110"}),e(f,{prop:"productName",label:"产品名称",align:"center",width:"140"}),e(f,{prop:"description",label:"产品描述",align:"center"}),e(f,{prop:"services",label:"服务",align:"center",width:"260"},{default:l(({row:a,$index:O})=>[e(I,{type:a.services.hasSevenDaysReturn?"":"info"},{default:l(()=>[_("七天无理由")]),_:2},1032,["type"]),e(I,{type:a.services.hasAfterSalesWarranty?"":"info"},{default:l(()=>[_("售后保修")]),_:2},1032,["type"]),e(I,{type:a.services.hasThreeForOneGuarantee?"":"info"},{default:l(()=>[_("假一赔三")]),_:2},1032,["type"])]),_:1}),e(f,{prop:"movementType",label:"机芯类型",align:"center",width:"140"}),e(f,{prop:"totalSales",label:"总销售量",align:"center",width:"110"}),e(f,{prop:"totalStock",label:"总库存量",align:"center",width:"110"}),e(f,{prop:"photo",label:"产品图片",align:"center"},{default:l(({row:a,$index:O})=>[y("div",ml,[e(Be,{style:{width:"150px",height:"150px","z-index":"99"},src:a.photo,"preview-src-list":[a.photo],"zoom-rate":1.2,fit:"cover","close-on-press-escape":"","hide-on-click-modal":"","preview-teleported":""},null,8,["src","preview-src-list"])])]),_:1}),e(f,{prop:"address",label:"操作",align:"center",width:"210"},{default:l(({row:a,$index:O})=>[s(F).buttons.includes("添加商品类型")?(m(),x(u,{key:0,type:"primary",size:"small",icon:"Plus",onClick:W=>$e(a)},null,8,["onClick"])):R("",!0),e(u,{type:"primary",size:"small",icon:"InfoFilled",onClick:W=>Ue(a)},null,8,["onClick"]),s(F).buttons.includes("修改商品")?(m(),x(u,{key:1,type:"primary",size:"small",icon:"Edit",onClick:W=>Ne(a)},null,8,["onClick"])):R("",!0),s(F).buttons.includes("删除商品")?(m(),x(Me,{key:2,title:`确认删除${a.productName}商品？`,width:"200",onConfirm:W=>o.deleteTrademark(a._id)},{reference:l(()=>[e(u,{type:"danger",size:"small",icon:"Delete"})]),_:2},1032,["title","onConfirm"])):R("",!0)]),_:1})]),_:1},8,["data"])),[[_e,V.tableLoading]]),e(Ge,{"current-page":s(B),"page-size":ye,layout:"prev, pager, next, jumper, total","hide-on-single-page":"",total:s(we),onCurrentChange:G},null,8,["current-page","total"])]),_:2},[s(F).buttons.includes("添加商品")?{name:"header",fn:l(()=>[e(u,{type:"primary",icon:"Plus",onClick:ke},{default:l(()=>[_(" 添加商品 ")]),_:1})]),key:"0"}:void 0]),1024),e(ce,{modelValue:s(g),"onUpdate:modelValue":t[8]||(t[8]=a=>U(g)?g.value=a:g=a),title:s(Q),width:"55%",top:"8vh","lock-scroll":"","close-on-press-escape":"","show-close":!1,center:""},{footer:l(()=>[e(u,{onClick:t[7]||(t[7]=a=>U(g)?g.value=!1:g=!1)},{default:l(()=>[_("取消")]),_:1}),e(u,{type:"primary",onClick:Te},{default:l(()=>[_("确认")]),_:1})]),default:l(()=>[e(pe,{model:s(n),rules:ne,ref_key:"formRef",ref:k},{default:l(()=>[e(c,{label:"品牌名称：","label-width":"100px",prop:"brandName"},{default:l(()=>[e(Oe,{modelValue:s(n).brandName,"onUpdate:modelValue":t[0]||(t[0]=a=>s(n).brandName=a),class:"m-2",placeholder:"品牌名称",disabled:s(M)},{default:l(()=>[(m(!0),T(fe,null,ve(s(Y),a=>(m(),x(Ee,{key:a.brandName,label:a.brandName,value:a.brandName},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),e(c,{label:"产品名称：","label-width":"100px",prop:"productName"},{default:l(()=>[e(D,{style:{width:"50%"},modelValue:s(n).productName,"onUpdate:modelValue":t[1]||(t[1]=a=>s(n).productName=a),clearable:"",disabled:s(M)},null,8,["modelValue","disabled"])]),_:1}),e(c,{label:"机芯类型","label-width":"100px",prop:"movementType"},{default:l(()=>[e(D,{style:{width:"50%"},modelValue:s(n).movementType,"onUpdate:modelValue":t[2]||(t[2]=a=>s(n).movementType=a),clearable:""},null,8,["modelValue"])]),_:1}),e(c,{label:"产品描述：","label-width":"100px",prop:"description"},{default:l(()=>[e(D,{modelValue:s(n).description,"onUpdate:modelValue":t[3]||(t[3]=a=>s(n).description=a),autosize:"",type:"textarea",placeholder:"产品描述"},null,8,["modelValue"])]),_:1}),e(c,{label:"服务：","label-width":"100px",prop:"description"},{default:l(()=>[e(q,{modelValue:s(n).services.hasSevenDaysReturn,"onUpdate:modelValue":t[4]||(t[4]=a=>s(n).services.hasSevenDaysReturn=a),label:"七天无理由",border:""},null,8,["modelValue"]),e(q,{modelValue:s(n).services.hasAfterSalesWarranty,"onUpdate:modelValue":t[5]||(t[5]=a=>s(n).services.hasAfterSalesWarranty=a),label:"售后保修",border:""},null,8,["modelValue"]),e(q,{modelValue:s(n).services.hasThreeForOneGuarantee,"onUpdate:modelValue":t[6]||(t[6]=a=>s(n).services.hasThreeForOneGuarantee=a),label:"假一赔三",border:""},null,8,["modelValue"])]),_:1}),e(c,{label:"照片图片","label-width":"100px",prop:"photo"},{default:l(()=>[e(ue,{class:"avatar-uploader",action:"http://127.0.0.1:3000/upload/productDisplay","show-file-list":!1,"on-success":Se,"before-upload":re,name:"productDisplay"},{default:l(()=>[s(n).photo?(m(),T("img",{key:0,src:s(n).photo,class:"avatar"},null,8,_l)):(m(),x(A,{key:1,class:"avatar-uploader-icon"},{default:l(()=>[e(de)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(ce,{modelValue:s(b),"onUpdate:modelValue":t[18]||(t[18]=a=>U(b)?b.value=a:b=a),title:"添加具体手表类型",width:"55%",top:"8vh","lock-scroll":"","close-on-press-escape":"","show-close":!1,center:""},{footer:l(()=>[e(u,{onClick:t[17]||(t[17]=a=>U(b)?b.value=!1:b=!1)},{default:l(()=>[_("取消")]),_:1}),e(u,{type:"primary",onClick:ze},{default:l(()=>[_("确认")]),_:1})]),default:l(()=>[e(pe,{model:i,rules:ne,ref_key:"formRef",ref:k},{default:l(()=>[e(c,{label:"品牌名称：","label-width":"100px",prop:"brandName"},{default:l(()=>[e(D,{style:{width:"30%"},modelValue:i.brandName,"onUpdate:modelValue":t[9]||(t[9]=a=>i.brandName=a),clearable:"",disabled:""},null,8,["modelValue"])]),_:1}),e(c,{label:"产品名称：","label-width":"100px",prop:"productName"},{default:l(()=>[e(D,{style:{width:"30%"},modelValue:i.productName,"onUpdate:modelValue":t[10]||(t[10]=a=>i.productName=a),clearable:"",disabled:""},null,8,["modelValue"])]),_:1}),e(c,{label:"产品颜色：","label-width":"100px",prop:"color"},{default:l(()=>[e(D,{style:{width:"30%"},modelValue:i.color,"onUpdate:modelValue":t[11]||(t[11]=a=>i.color=a),clearable:""},null,8,["modelValue"])]),_:1}),e(c,{label:"成本花费：","label-width":"100px",prop:"purchasingPrice"},{default:l(()=>[e(K,{modelValue:i.purchasingPrice,"onUpdate:modelValue":t[12]||(t[12]=a=>i.purchasingPrice=a),class:"mx-4"},null,8,["modelValue"])]),_:1}),e(c,{label:"产品售价：","label-width":"100px",prop:"current_selling_price"},{default:l(()=>[e(K,{modelValue:i.current_selling_price,"onUpdate:modelValue":t[13]||(t[13]=a=>i.current_selling_price=a),class:"mx-4"},null,8,["modelValue"])]),_:1}),e(c,{label:"现有库存：","label-width":"100px",prop:"stock"},{default:l(()=>[y("div",fl,[e(We,{modelValue:i.stock,"onUpdate:modelValue":t[14]||(t[14]=a=>i.stock=a),"show-input":""},null,8,["modelValue"])])]),_:1}),e(c,{label:"现已销售：","label-width":"100px",prop:"sales"},{default:l(()=>[e(K,{modelValue:i.sales,"onUpdate:modelValue":t[15]||(t[15]=a=>i.sales=a),class:"mx-4"},null,8,["modelValue"])]),_:1}),e(c,{label:"是否上架：","label-width":"100px",prop:"isSale"},{default:l(()=>[e(me,{content:`已${i.isSale?"上":"下"}架`,placement:"top"},{default:l(()=>[e(He,{modelValue:o.value2,"onUpdate:modelValue":t[16]||(t[16]=a=>o.value2=a),class:"mt-2",style:{"margin-left":"24px"},"inline-prompt":"","active-icon":o.Check,"inactive-icon":o.Close},null,8,["modelValue","active-icon","inactive-icon"])]),_:1},8,["content"])]),_:1}),e(c,{label:"照片图片","label-width":"100px",prop:"productPhoto"},{default:l(()=>[e(ue,{class:"avatar-uploader",action:"http://127.0.0.1:3000/upload/itemPic","show-file-list":!1,"on-success":Ce,"before-upload":re,name:"itemPic"},{default:l(()=>[i.productPhoto?(m(),T("img",{key:0,src:i.productPhoto,class:"avatar"},null,8,vl)):(m(),x(A,{key:1,class:"avatar-uploader-icon"},{default:l(()=>[e(de)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(Re,{modelValue:s($),"onUpdate:modelValue":t[22]||(t[22]=a=>U($)?$.value=a:$=a),title:"商品种类",direction:"rtl",size:"40%",id:"el-drawer"},{default:l(()=>[d._id?j((m(),T("div",gl,[e(E,{class:"el-row-showData"},{default:l(()=>[e(v,{span:6},{default:l(()=>[e(C,{title:"产品名称",value:s(L),"value-style":"display: none;"},{prefix:l(()=>[_(J(d.productName),1)]),_:1},8,["value"])]),_:1}),e(v,{span:6},{default:l(()=>[e(C,{title:"产品颜色",value:s(L),"value-style":"display: none;"},{prefix:l(()=>[_(J(d.color),1)]),_:1},8,["value"])]),_:1}),e(v,{span:6},{default:l(()=>[e(C,{title:"成本花费",value:d.purchasingPrice,suffix:"￥"},null,8,["value"])]),_:1}),e(v,{span:6},{default:l(()=>[e(C,{title:"产品售价",value:d.current_selling_price,suffix:"￥"},null,8,["value"])]),_:1})]),_:1}),e(E,{class:"el-row-showData"},{default:l(()=>[e(v,{span:6},{default:l(()=>[e(C,{title:"现有库存",value:d.stock},null,8,["value"])]),_:1}),e(v,{span:6},{default:l(()=>[e(C,{title:"现已销售",value:d.sales},null,8,["value"])]),_:1}),e(v,{span:6},{default:l(()=>[e(C,{value:s(L),"value-style":"display: none;"},{title:l(()=>[y("div",bl,[_(" 是否在售 "),e(me,{effect:"dark",content:"点击切换上下架",placement:"top"},{default:l(()=>[e(A,{style:{"margin-left":"4px"},size:12},{default:l(()=>[e(je)]),_:1})]),_:1})])]),prefix:l(()=>[e(u,{circle:"",type:"success",onClick:xe},{default:l(()=>[_(J(d.isSale?"是":"否"),1)]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(E,{class:"el-row-showData"},{default:l(()=>[e(v,{span:6},{default:l(()=>[hl]),_:1}),e(v,{span:18},{default:l(()=>[y("div",{id:"productImg",onMousemove:t[19]||(t[19]=a=>De(a)),ref_key:"hintContainer",ref:ee,onMouseenter:t[20]||(t[20]=a=>U(w)?w.value=!0:w=!0),onMouseleave:t[21]||(t[21]=a=>U(w)?w.value=!1:w=!1)},[j(y("div",{id:"myMouseEnterHint",ref_key:"hint",ref:N,style:ge({"--hint-top":`${s(P)}px`,"--hint-left":`${s(S)}px`})},null,4),[[be,s(w)]]),y("img",{src:d.productPhoto,style:{width:"300px",height:"300px",border:"2px solid #a8a8a8"}},null,8,yl)],544)]),_:1})]),_:1}),e(E,{gutter:10,class:"steps-row",style:{"margin-top":"160px"}},{default:l(()=>[e(v,{span:3}),e(Qe,{active:s(L),"process-status":"process","finish-status":"wait","align-center":""},{default:l(()=>[(m(!0),T(fe,null,ve(d.allColor,(a,O)=>(m(),x(Je,{key:a},{description:l(()=>[e(u,{style:{"margin-top":"10px"},onClick:W=>Ie(d.productName,O+1),round:"",bg:"",text:""},{default:l(()=>[_(J(a),1)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1},8,["active"])]),_:1}),j(y("div",wl,[y("img",{src:d.productPhoto,alt:"",id:"bigImg",style:ge({"--bigImg-top":`${s(le)}px`,"--bigImg-left":`${s(te)}px`})},null,12,Vl)],512),[[be,s(w)]])])),[[_e,V.drawerLoading]]):(m(),T("div",xl,[e(Ke,{class:"mx-1",type:"warning",size:"large"},{default:l(()=>[e(A,null,{default:l(()=>[e(qe)]),_:1}),_(" 该商品暂时无具体分类，请从页面表格中添加")]),_:1})]))]),_:1},8,["modelValue"])])}}});const Tl=nl(kl,[["__scopeId","data-v-ee5666eb"]]);export{Tl as default};
