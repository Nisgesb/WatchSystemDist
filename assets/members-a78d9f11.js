import{d as ee,u as le,r as p,b as D,s as oe,D as se,c as n,G as te,o as i,e as A,g as e,H as ae,h as t,w as o,i as f,I as ne,j as V,n as N,f as c,F as re,l as de,t as ue,J as pe,K as ie,L as x,M as ce,N as me,O as _e,p as fe,k as ge,_ as ye}from"./index-0d643a49.js";const U=h=>(fe("data-v-710da537"),h=h(),ge(),h),be=U(()=>c("h4",null,"分配用户角色",-1)),ve=U(()=>c("p",{style:{"line-height":"32px"},class:""},"用户名",-1)),we=U(()=>c("p",{style:{"line-height":"32px"},class:""},"持有者",-1)),Ve={style:{display:"flex"}},xe=U(()=>c("p",null,"职位列表",-1)),he={style:{flex:"auto"}},Ue={class:"dialog-footer"},z=12,Ce=ee({__name:"members",setup(h){const g=le();let y=p(1),R=p(0),F=p([]),B=p(0),m=p(!1),C=p(!1);const b=p(!1);let $=D([]),r=D({_id:"",username:"",possessor:"",roleId:""});const d=D({username:"",password:"",possessor:""}),P=async()=>{(await ie(d.username,d.password,d.possessor)).code==200?(x({type:"success",message:"添加成功"}),v(1),b.value=!1):x({type:"error",message:"添加失败，请稍后重试"})},E=async()=>{const a=await ce(r);m.value=!1,a.code==200&&(x({type:"success",message:"修改成功"}),v(y.value))},L=async a=>{r._id=a._id,r.username=a.username,r.possessor=a.possessor,r.roleId=a.roleId,console.log(a),m.value=!0},v=async a=>{C.value=!0;let s=await me(a,z);R.value=s.totalCount,F.value=s.data,B.value=s.totalPage,C.value=!1},M=a=>{y.value=a,v(y.value)},j=async a=>{(await _e(a)).code==200?(x({type:"success",message:"删除成功"}),v(y.value)):x({type:"error",message:"服务器异常，请稍后重试"})},T=async()=>{b.value=!0};return oe(async()=>{(await se()).data.forEach(s=>{$.push(s)}),v(1)}),(a,s)=>{const _=n("el-button"),u=n("el-table-column"),G=n("el-popconfirm"),H=n("el-table"),J=n("el-pagination"),K=n("el-card"),w=n("el-input"),k=n("el-row"),O=n("el-radio"),q=n("el-radio-group"),Q=n("el-drawer"),I=n("el-form-item"),W=n("el-form"),X=n("el-dialog"),Y=te("loading");return i(),A("div",null,[e(K,{class:"box-card",shadow:"always"},ae({default:o(()=>[ne((i(),V(H,{border:"",data:t(F),"element-loading-text":"加载中..."},{default:o(()=>[e(u,{label:"序号",type:"index",align:"center"}),e(u,{prop:"username",label:"用户名",align:"center"}),e(u,{prop:"possessor",label:"持有者",align:"center"},{default:o(({row:l,$index:S})=>[]),_:1}),e(u,{prop:"permissionName",label:"用户角色",align:"center"},{default:o(({row:l,$index:S})=>[]),_:1}),e(u,{prop:"registrationDate",label:"创建时间",align:"center"},{default:o(({row:l,$index:S})=>[]),_:1}),e(u,{prop:"lastUpdateTime",label:"修改时间",align:"center"}),t(g).buttons.includes("分配角色")||t(g).buttons.includes("删除用户")?(i(),V(u,{key:0,prop:"eee",label:"操作",align:"center"},{default:o(({row:l,$index:S})=>[t(g).buttons.includes("分配角色")?(i(),V(_,{key:0,type:"primary",size:"small",icon:"User",onClick:Z=>L(l)},{default:o(()=>[f("分配角色")]),_:2},1032,["onClick"])):N("",!0),t(g).buttons.includes("删除用户")?(i(),V(G,{key:1,title:"6",onConfirm:Z=>j(l._id)},{reference:o(()=>[e(_,{type:"danger",size:"small",icon:"Delete"})]),_:2},1032,["onConfirm"])):N("",!0)]),_:1})):N("",!0)]),_:1},8,["data"])),[[Y,t(C)]]),e(J,{"current-page":t(y),"page-size":z,layout:"prev, pager, next, jumper, total","hide-on-single-page":"",total:t(R),onCurrentChange:M},null,8,["current-page","total"])]),_:2},[t(g).buttons.includes("添加用户")?{name:"header",fn:o(()=>[e(_,{type:"primary",icon:"Plus",onClick:T},{default:o(()=>[f(" 添加用户 ")]),_:1})]),key:"0"}:void 0]),1024),e(Q,{modelValue:t(m),"onUpdate:modelValue":s[3]||(s[3]=l=>pe(m)?m.value=l:m=l)},{header:o(()=>[be]),default:o(()=>[e(k,{class:"drawerRow"},{default:o(()=>[ve,e(w,{modelValue:t(r).username,"onUpdate:modelValue":s[0]||(s[0]=l=>t(r).username=l),placeholder:t(r).username,style:{width:"250px"},clearable:""},null,8,["modelValue","placeholder"])]),_:1}),e(k,{class:"drawerRow"},{default:o(()=>[we,e(w,{modelValue:t(r).possessor,"onUpdate:modelValue":s[1]||(s[1]=l=>t(r).possessor=l),placeholder:t(r).possessor,style:{width:"250px"},clearable:""},null,8,["modelValue","placeholder"])]),_:1}),e(k,{class:"drawerRow"},{default:o(()=>[c("div",Ve,[xe,e(q,{modelValue:t(r).roleId,"onUpdate:modelValue":s[2]||(s[2]=l=>t(r).roleId=l),style:{"margin-top":"30px"}},{default:o(()=>[(i(!0),A(re,null,de(t($),l=>(i(),V(O,{label:l._id,border:"",key:l._id},{default:o(()=>[f(ue(l.permissionName),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),footer:o(()=>[c("div",he,[e(_,{type:"primary",onClick:E},{default:o(()=>[f("确认")]),_:1})])]),_:1},8,["modelValue"]),e(X,{modelValue:b.value,"onUpdate:modelValue":s[8]||(s[8]=l=>b.value=l),title:"Shipping address"},{footer:o(()=>[c("span",Ue,[e(_,{onClick:s[7]||(s[7]=l=>b.value=!1)},{default:o(()=>[f("取消")]),_:1}),e(_,{type:"primary",onClick:P},{default:o(()=>[f(" 提交 ")]),_:1})])]),default:o(()=>[e(W,{model:d},{default:o(()=>[e(I,{label:"用户名"},{default:o(()=>[e(w,{modelValue:d.username,"onUpdate:modelValue":s[4]||(s[4]=l=>d.username=l),autocomplete:"off",style:{width:"330px"}},null,8,["modelValue"])]),_:1}),e(I,{label:"密码"},{default:o(()=>[e(w,{type:"password",modelValue:d.password,"onUpdate:modelValue":s[5]||(s[5]=l=>d.password=l),autocomplete:"off",style:{width:"330px"}},null,8,["modelValue"])]),_:1}),e(I,{label:"持有人"},{default:o(()=>[e(w,{modelValue:d.possessor,"onUpdate:modelValue":s[6]||(s[6]=l=>d.possessor=l),autocomplete:"off",style:{width:"330px"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});const Ie=ye(Ce,[["__scopeId","data-v-710da537"]]);export{Ie as default};
