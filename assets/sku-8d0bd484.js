import{d as Ke,r as p,b as W,u as Xe,v as Ye,c as r,H as Re,o as f,e as C,g as e,w as l,i as m,I as H,j as L,h as s,f as y,J as T,F as me,l as _e,t as j,z as fe,V as ve,S as Ze,L as h,p as el,k as ll,A as tl,_ as al}from"./index-11b72287.js";import{b as ol,c as sl,d as ge,e as nl}from"./index-ebb518bf.js";import{c as rl}from"./index-58395825.js";const il=z=>(el("data-v-b1178c3d"),z=z(),ll(),z),dl={id:"container"},ul={class:"demo-image__preview"},pl=["src"],cl={class:"slider-demo-block",style:{width:"50%"}},ml=["src"],_l={key:0,"element-loading-text":"加载中..."},fl={style:{display:"inline-flex","align-items":"center"}},vl=il(()=>y("span",null,"产品图片",-1)),gl=["src"],bl={id:"showBigProductImg"},hl=["src"],yl={key:1},be=3,wl=Ke({__name:"sku",setup(z){let B=p(1),he=p(8),K=p([]),ye=p(3),J=p(""),g=p(!1),X=p([]),x=p(),n=W({_id:0,brandName:"",productName:"",description:"",services:{hasSevenDaysReturn:!1,hasAfterSalesWarranty:!1,hasThreeForOneGuarantee:!1},movementType:"",photo:""}),M=p(),D=p(!1),Y=p(1);const d=W({_id:"",color:"",productName:"",purchasingPrice:0,current_selling_price:0,isSale:"",productPhoto:"",sales:0,stock:0,allColor:[]});let R=p(),k=p(),N=p(""),P=p(""),Z=p(""),ee=p(""),w=p(!1),$=p(0);Xe();let b=p(!1);const i=W({productName:"",color:"",purchasingPrice:"",current_selling_price:"",stock:"",sales:"",isSale:"",productPhoto:""}),we=()=>{Ze.alert(`是否将商品${d.isSale?"下架":"上架"}`,`${d.isSale?"下架":"上架"}`,{confirmButtonText:"OK",callback:o=>{o=="confirm"?console.log(o):h({type:"info",message:"已取消操作"})}})},V=W({drawerLoading:!1,tableLoading:!1}),le=async o=>{V.tableLoading=!0;let t=await ol(o,be);K.value=t.data,V.tableLoading=!1},A=o=>{B.value=o,le(o)},te=o=>{o?(n._id=o._id,n.brandName=o.brandName,n.productName=o.productName,n.description=o.description,n.services=o.services,n.movementType=o.movementType,n.photo=o.photo,J.value="修改商品信息",M.value=!0):(n._id=0,n.brandName="",n.productName="",n.description="",n.services={hasSevenDaysReturn:!1,hasAfterSalesWarranty:!1,hasThreeForOneGuarantee:!1},n.movementType="",n.photo="",J.value="添加商品",M.value=!1),tl(()=>{var t,u,_,U;(t=x.value)==null||t.clearValidate("brandName"),(u=x.value)==null||u.clearValidate("movementType"),(_=x.value)==null||_.clearValidate("productName"),(U=x.value)==null||U.clearValidate("photo")}),g.value=!0},Ve=()=>{te()},xe=o=>{te(o)},ke=(o,t,u)=>{t.trim().length>=1?u():(h({type:"error",message:"必须选择属于哪一个品牌"}),u(new Error("必须选择属于哪一个品牌")))},ae=(o,t,u)=>{t.trim().length>=1?u():u(new Error("必须填写"))},oe={brandName:[{required:!0,trigger:"blur",validator:ke}],movementType:[{required:!0,trigger:"blur",validator:ae}],productName:[{required:!0,trigger:"blur",validator:ae}],photo:[{required:!0,validator:(o,t,u)=>{t?u():(h({type:"error",message:"商品图片必须上传"}),u(new Error("商品图片必须上传")))}}]},se=o=>o.size/1024/1024<4?o.type=="image/jpeg"||o.type=="image/png"||o.type=="image/gif"||o.type=="image/webp"?!0:(h({type:"error",message:"上传文件格式必须为JPG、PNG、GIT、WEBP"}),!1):(h({type:"error",message:"上传文件大小必须小于4M"}),!1),Ne=o=>{console.log(o.imageUrl),n.photo=o.imageUrl+"?imageMogr2/format/webp/blur/1x0/quality/66"},Pe=o=>{console.log(o.imageUrl),i.productPhoto=o.imageUrl+"?imageMogr2/format/webp/blur/1x0/quality/66"},Se=async()=>{await x.value.validate(),g.value=!1,(await sl(n)).code==200?h({type:"success",message:"提交成功！"}):h({type:"error",message:"服务器异常，请稍后重试"}),n._id&&n._id!==0?A(B.value):A(ye.value)},ne=o=>{o.data?(d._id=o.data._id,d.color=o.data.color,d.allColor=o.data.allColor,d.productName=o.data.productName,d.purchasingPrice=o.data.purchasingPrice,d.current_selling_price=o.data.current_selling_price,d.isSale=o.data.isSale,d.sales=o.data.sales,d.stock=o.data.stock,d.productPhoto=o.data.productPhoto):d._id=""},Ce=async o=>{Y.value=1,D.value=!0,V.drawerLoading=!0;const t=await ge({productName:o.productName,pageNumber:Y.value});ne(t),V.drawerLoading=!1},Te=async(o,t)=>{V.drawerLoading=!0,$.value=t-1;const u=await ge({productName:o,pageNumber:t});ne(u),V.drawerLoading=!1},Ue=o=>{const t=R.value.getBoundingClientRect();N.value=o.clientY-t.top-k.value.offsetHeight/2,P.value=o.clientX-t.left-k.value.offsetWidth/2,N.value=N.value<0?0:N.value>300-k.value.offsetHeight?300-k.value.offsetHeight:N.value,P.value=P.value<0?0:P.value>300-k.value.offsetHeight?300-k.value.offsetHeight:P.value,Z.value=-N.value*3,ee.value=-P.value*3},Ie=o=>{b.value=!0,i.brandName=o.brandName,i.productName=o.productName},De=()=>{i.productName="",i.color="",i.purchasingPrice="",i.current_selling_price="",i.stock="",i.sales="",i.isSale="",i.productPhoto=""},$e=async()=>{(await nl(i)).code==200?(b.value=!1,De(),A(B.value),h({type:"success",message:"提交成功！"})):h({type:"error",message:"服务器异常，请稍后重试"})};return Ye(async()=>{le(1),X.value=(await rl()).data}),(o,t)=>{const u=r("el-button"),_=r("el-table-column"),U=r("el-tag"),Le=r("el-image"),ze=r("el-popconfirm"),Be=r("el-table"),Me=r("el-pagination"),Ae=r("el-card"),Fe=r("el-option"),Ee=r("el-select"),c=r("el-form-item"),I=r("el-input"),Q=r("el-checkbox"),re=r("Plus"),F=r("el-icon"),ie=r("el-upload"),de=r("el-form"),ue=r("el-dialog"),q=r("el-input-number"),Ge=r("el-slider"),Oe=r("el-switch"),pe=r("el-tooltip"),S=r("el-statistic"),v=r("el-col"),E=r("el-row"),We=r("QuestionFilled"),He=r("el-step"),je=r("el-steps"),Je=r("Bell"),Qe=r("el-text"),qe=r("el-drawer"),ce=Re("loading");return f(),C("div",dl,[e(Ae,{class:"box-card",shadow:"always"},{header:l(()=>[e(u,{type:"primary",icon:"Plus",onClick:Ve},{default:l(()=>[m(" 添加商品 ")]),_:1})]),default:l(()=>[H((f(),L(Be,{border:"",data:s(K),"element-loading-text":"加载中..."},{default:l(()=>[e(_,{label:"序号",type:"index",align:"center",width:"60"}),e(_,{prop:"brandName",label:"品牌名称",align:"center",width:"110"}),e(_,{prop:"productName",label:"产品名称",align:"center",width:"140"}),e(_,{prop:"description",label:"产品描述",align:"center"}),e(_,{prop:"services",label:"服务",align:"center",width:"260"},{default:l(({row:a,$index:G})=>[e(U,{type:a.services.hasSevenDaysReturn?"":"info"},{default:l(()=>[m("七天无理由")]),_:2},1032,["type"]),e(U,{type:a.services.hasAfterSalesWarranty?"":"info"},{default:l(()=>[m("售后保修")]),_:2},1032,["type"]),e(U,{type:a.services.hasThreeForOneGuarantee?"":"info"},{default:l(()=>[m("假一赔三")]),_:2},1032,["type"])]),_:1}),e(_,{prop:"movementType",label:"机芯类型",align:"center",width:"140"}),e(_,{prop:"totalSales",label:"总销售量",align:"center",width:"110"}),e(_,{prop:"totalStock",label:"总库存量",align:"center",width:"110"}),e(_,{prop:"photo",label:"产品图片",align:"center"},{default:l(({row:a,$index:G})=>[y("div",ul,[e(Le,{style:{width:"150px",height:"150px","z-index":"99"},src:a.photo,"preview-src-list":[a.photo],"zoom-rate":1.2,fit:"cover","close-on-press-escape":"","hide-on-click-modal":"","preview-teleported":""},null,8,["src","preview-src-list"])])]),_:1}),e(_,{prop:"address",label:"操作",align:"center",width:"210"},{default:l(({row:a,$index:G})=>[e(u,{type:"primary",size:"small",icon:"Plus",onClick:O=>Ie(a)},null,8,["onClick"]),e(u,{type:"primary",size:"small",icon:"InfoFilled",onClick:O=>Ce(a)},null,8,["onClick"]),e(u,{type:"primary",size:"small",icon:"Edit",onClick:O=>xe(a)},null,8,["onClick"]),e(ze,{title:`确认删除${a.productName}商品？`,width:"200",onConfirm:O=>o.deleteTrademark(a._id)},{reference:l(()=>[e(u,{type:"danger",size:"small",icon:"Delete"})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"])),[[ce,V.tableLoading]]),e(Me,{"current-page":s(B),"page-size":be,layout:"prev, pager, next, jumper, total","hide-on-single-page":"",total:s(he),onCurrentChange:A},null,8,["current-page","total"])]),_:1}),e(ue,{modelValue:s(g),"onUpdate:modelValue":t[8]||(t[8]=a=>T(g)?g.value=a:g=a),title:s(J),width:"55%",top:"8vh","lock-scroll":"","close-on-press-escape":"","show-close":!1,center:""},{footer:l(()=>[e(u,{onClick:t[7]||(t[7]=a=>T(g)?g.value=!1:g=!1)},{default:l(()=>[m("取消")]),_:1}),e(u,{type:"primary",onClick:Se},{default:l(()=>[m("确认")]),_:1})]),default:l(()=>[e(de,{model:s(n),rules:oe,ref_key:"formRef",ref:x},{default:l(()=>[e(c,{label:"品牌名称：","label-width":"100px",prop:"brandName"},{default:l(()=>[e(Ee,{modelValue:s(n).brandName,"onUpdate:modelValue":t[0]||(t[0]=a=>s(n).brandName=a),class:"m-2",placeholder:"品牌名称",disabled:s(M)},{default:l(()=>[(f(!0),C(me,null,_e(s(X),a=>(f(),L(Fe,{key:a.brandName,label:a.brandName,value:a.brandName},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),e(c,{label:"产品名称：","label-width":"100px",prop:"productName"},{default:l(()=>[e(I,{style:{width:"50%"},modelValue:s(n).productName,"onUpdate:modelValue":t[1]||(t[1]=a=>s(n).productName=a),clearable:"",disabled:s(M)},null,8,["modelValue","disabled"])]),_:1}),e(c,{label:"机芯类型","label-width":"100px",prop:"movementType"},{default:l(()=>[e(I,{style:{width:"50%"},modelValue:s(n).movementType,"onUpdate:modelValue":t[2]||(t[2]=a=>s(n).movementType=a),clearable:""},null,8,["modelValue"])]),_:1}),e(c,{label:"产品描述：","label-width":"100px",prop:"description"},{default:l(()=>[e(I,{modelValue:s(n).description,"onUpdate:modelValue":t[3]||(t[3]=a=>s(n).description=a),autosize:"",type:"textarea",placeholder:"产品描述"},null,8,["modelValue"])]),_:1}),e(c,{label:"服务：","label-width":"100px",prop:"description"},{default:l(()=>[e(Q,{modelValue:s(n).services.hasSevenDaysReturn,"onUpdate:modelValue":t[4]||(t[4]=a=>s(n).services.hasSevenDaysReturn=a),label:"七天无理由",border:""},null,8,["modelValue"]),e(Q,{modelValue:s(n).services.hasAfterSalesWarranty,"onUpdate:modelValue":t[5]||(t[5]=a=>s(n).services.hasAfterSalesWarranty=a),label:"售后保修",border:""},null,8,["modelValue"]),e(Q,{modelValue:s(n).services.hasThreeForOneGuarantee,"onUpdate:modelValue":t[6]||(t[6]=a=>s(n).services.hasThreeForOneGuarantee=a),label:"假一赔三",border:""},null,8,["modelValue"])]),_:1}),e(c,{label:"照片图片","label-width":"100px",prop:"photo"},{default:l(()=>[e(ie,{class:"avatar-uploader",action:"http://127.0.0.1:3000/upload/productDisplay","show-file-list":!1,"on-success":Ne,"before-upload":se,name:"productDisplay"},{default:l(()=>[s(n).photo?(f(),C("img",{key:0,src:s(n).photo,class:"avatar"},null,8,pl)):(f(),L(F,{key:1,class:"avatar-uploader-icon"},{default:l(()=>[e(re)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(ue,{modelValue:s(b),"onUpdate:modelValue":t[18]||(t[18]=a=>T(b)?b.value=a:b=a),title:"添加具体手表类型",width:"55%",top:"8vh","lock-scroll":"","close-on-press-escape":"","show-close":!1,center:""},{footer:l(()=>[e(u,{onClick:t[17]||(t[17]=a=>T(b)?b.value=!1:b=!1)},{default:l(()=>[m("取消")]),_:1}),e(u,{type:"primary",onClick:$e},{default:l(()=>[m("确认")]),_:1})]),default:l(()=>[e(de,{model:i,rules:oe,ref_key:"formRef",ref:x},{default:l(()=>[e(c,{label:"品牌名称：","label-width":"100px",prop:"brandName"},{default:l(()=>[e(I,{style:{width:"30%"},modelValue:i.brandName,"onUpdate:modelValue":t[9]||(t[9]=a=>i.brandName=a),clearable:"",disabled:""},null,8,["modelValue"])]),_:1}),e(c,{label:"产品名称：","label-width":"100px",prop:"productName"},{default:l(()=>[e(I,{style:{width:"30%"},modelValue:i.productName,"onUpdate:modelValue":t[10]||(t[10]=a=>i.productName=a),clearable:"",disabled:""},null,8,["modelValue"])]),_:1}),e(c,{label:"产品颜色：","label-width":"100px",prop:"color"},{default:l(()=>[e(I,{style:{width:"30%"},modelValue:i.color,"onUpdate:modelValue":t[11]||(t[11]=a=>i.color=a),clearable:""},null,8,["modelValue"])]),_:1}),e(c,{label:"成本花费：","label-width":"100px",prop:"purchasingPrice"},{default:l(()=>[e(q,{modelValue:i.purchasingPrice,"onUpdate:modelValue":t[12]||(t[12]=a=>i.purchasingPrice=a),class:"mx-4"},null,8,["modelValue"])]),_:1}),e(c,{label:"产品售价：","label-width":"100px",prop:"current_selling_price"},{default:l(()=>[e(q,{modelValue:i.current_selling_price,"onUpdate:modelValue":t[13]||(t[13]=a=>i.current_selling_price=a),class:"mx-4"},null,8,["modelValue"])]),_:1}),e(c,{label:"现有库存：","label-width":"100px",prop:"stock"},{default:l(()=>[y("div",cl,[e(Ge,{modelValue:i.stock,"onUpdate:modelValue":t[14]||(t[14]=a=>i.stock=a),"show-input":""},null,8,["modelValue"])])]),_:1}),e(c,{label:"现已销售：","label-width":"100px",prop:"sales"},{default:l(()=>[e(q,{modelValue:i.sales,"onUpdate:modelValue":t[15]||(t[15]=a=>i.sales=a),class:"mx-4"},null,8,["modelValue"])]),_:1}),e(c,{label:"是否上架：","label-width":"100px",prop:"isSale"},{default:l(()=>[e(pe,{content:`已${i.isSale?"上":"下"}架`,placement:"top"},{default:l(()=>[e(Oe,{modelValue:o.value2,"onUpdate:modelValue":t[16]||(t[16]=a=>o.value2=a),class:"mt-2",style:{"margin-left":"24px"},"inline-prompt":"","active-icon":o.Check,"inactive-icon":o.Close},null,8,["modelValue","active-icon","inactive-icon"])]),_:1},8,["content"])]),_:1}),e(c,{label:"照片图片","label-width":"100px",prop:"productPhoto"},{default:l(()=>[e(ie,{class:"avatar-uploader",action:"http://127.0.0.1:3000/upload/itemPic","show-file-list":!1,"on-success":Pe,"before-upload":se,name:"itemPic"},{default:l(()=>[i.productPhoto?(f(),C("img",{key:0,src:i.productPhoto,class:"avatar"},null,8,ml)):(f(),L(F,{key:1,class:"avatar-uploader-icon"},{default:l(()=>[e(re)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(qe,{modelValue:s(D),"onUpdate:modelValue":t[22]||(t[22]=a=>T(D)?D.value=a:D=a),title:"商品种类",direction:"rtl",size:"40%",id:"el-drawer"},{default:l(()=>[d._id?H((f(),C("div",_l,[e(E,{class:"el-row-showData"},{default:l(()=>[e(v,{span:6},{default:l(()=>[e(S,{title:"产品名称",value:s($),"value-style":"display: none;"},{prefix:l(()=>[m(j(d.productName),1)]),_:1},8,["value"])]),_:1}),e(v,{span:6},{default:l(()=>[e(S,{title:"产品颜色",value:s($),"value-style":"display: none;"},{prefix:l(()=>[m(j(d.color),1)]),_:1},8,["value"])]),_:1}),e(v,{span:6},{default:l(()=>[e(S,{title:"成本花费",value:d.purchasingPrice,suffix:"￥"},null,8,["value"])]),_:1}),e(v,{span:6},{default:l(()=>[e(S,{title:"产品售价",value:d.current_selling_price,suffix:"￥"},null,8,["value"])]),_:1})]),_:1}),e(E,{class:"el-row-showData"},{default:l(()=>[e(v,{span:6},{default:l(()=>[e(S,{title:"现有库存",value:d.stock},null,8,["value"])]),_:1}),e(v,{span:6},{default:l(()=>[e(S,{title:"现已销售",value:d.sales},null,8,["value"])]),_:1}),e(v,{span:6},{default:l(()=>[e(S,{value:s($),"value-style":"display: none;"},{title:l(()=>[y("div",fl,[m(" 是否在售 "),e(pe,{effect:"dark",content:"点击切换上下架",placement:"top"},{default:l(()=>[e(F,{style:{"margin-left":"4px"},size:12},{default:l(()=>[e(We)]),_:1})]),_:1})])]),prefix:l(()=>[e(u,{circle:"",type:"success",onClick:we},{default:l(()=>[m(j(d.isSale?"是":"否"),1)]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(E,{class:"el-row-showData"},{default:l(()=>[e(v,{span:6},{default:l(()=>[vl]),_:1}),e(v,{span:18},{default:l(()=>[y("div",{id:"productImg",onMousemove:t[19]||(t[19]=a=>Ue(a)),ref_key:"hintContainer",ref:R,onMouseenter:t[20]||(t[20]=a=>T(w)?w.value=!0:w=!0),onMouseleave:t[21]||(t[21]=a=>T(w)?w.value=!1:w=!1)},[H(y("div",{id:"myMouseEnterHint",ref_key:"hint",ref:k,style:fe({"--hint-top":`${s(N)}px`,"--hint-left":`${s(P)}px`})},null,4),[[ve,s(w)]]),y("img",{src:d.productPhoto,style:{width:"300px",height:"300px",border:"2px solid #a8a8a8"}},null,8,gl)],544)]),_:1})]),_:1}),e(E,{gutter:10,class:"steps-row",style:{"margin-top":"160px"}},{default:l(()=>[e(v,{span:3}),e(je,{active:s($),"process-status":"process","finish-status":"wait","align-center":""},{default:l(()=>[(f(!0),C(me,null,_e(d.allColor,(a,G)=>(f(),L(He,{key:a},{description:l(()=>[e(u,{style:{"margin-top":"10px"},onClick:O=>Te(d.productName,G+1),round:"",bg:"",text:""},{default:l(()=>[m(j(a),1)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1},8,["active"])]),_:1}),H(y("div",bl,[y("img",{src:d.productPhoto,alt:"",id:"bigImg",style:fe({"--bigImg-top":`${s(Z)}px`,"--bigImg-left":`${s(ee)}px`})},null,12,hl)],512),[[ve,s(w)]])])),[[ce,V.drawerLoading]]):(f(),C("div",yl,[e(Qe,{class:"mx-1",type:"warning",size:"large"},{default:l(()=>[e(F,null,{default:l(()=>[e(Je)]),_:1}),m(" 该商品暂时无具体分类，请从页面表格中添加")]),_:1})]))]),_:1},8,["modelValue"])])}}});const Pl=al(wl,[["__scopeId","data-v-b1178c3d"]]);export{Pl as default};
